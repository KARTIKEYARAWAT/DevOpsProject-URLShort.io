<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Architecture - Distributed URL Shortener</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 900px;
            margin: 0 auto;
            padding: 40px;
            background-color: #fff;
        }

        h1 {
            font-size: 3rem;
            font-weight: 800;
            color: #111;
            margin-bottom: 0.5rem;
            border-bottom: 3px solid #8b5cf6;
            /* Violet accent */
            padding-bottom: 15px;
        }

        .subtitle {
            font-size: 1.5rem;
            color: #666;
            margin-bottom: 3rem;
        }

        h2 {
            font-size: 2.2rem;
            font-weight: 600;
            margin-top: 3rem;
            margin-bottom: 1.5rem;
            color: #222;
            border-left: 5px solid #8b5cf6;
            padding-left: 15px;
        }

        h3 {
            font-size: 1.3rem;
            font-weight: 600;
            margin-top: 2rem;
            color: #444;
        }

        p {
            margin-bottom: 1.5rem;
            text-align: justify;
        }

        .diagram-container {
            background-color: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 40px;
            margin: 30px 0;
            text-align: center;
            overflow-x: auto;
        }

        .diagram-caption {
            font-size: 1.1rem;
            color: #64748b;
            margin-top: 15px;
            font-style: italic;
        }

        ul {
            margin-bottom: 1.5rem;
            padding-left: 20px;
        }

        li {
            margin-bottom: 0.8rem;
            font-size: 1.1rem;
        }

        footer {
            margin-top: 5rem;
            text-align: center;
            font-size: 0.9rem;
            color: #999;
            border-top: 1px solid #eee;
            padding-top: 20px;
        }

        /* Print Optimization */
        @media print {
            body {
                padding: 0.5in;
            }
        }
    </style>
</head>

<body>

    <h1>System Architecture</h1>
    <div class="subtitle">Distributed URL Shortener System • Technical Design</div>

    <h2>1. High-Level Overview</h2>
    <p>
        The system follows a classic <strong>Distributed System</strong> pattern, separating the responsibility of
        <em>Request Routing</em> from <em>Data Storage</em>. This decoupling allows the system to scale storage
        independently of request throughput.
    </p>

    <div class="diagram-container">
        <!-- Embedded SVG Diagram -->
        <svg width="600" height="300" viewBox="0 0 600 300" xmlns="http://www.w3.org/2000/svg">
            <!-- Client -->
            <rect x="20" y="110" width="80" height="60" rx="5" fill="#e2e8f0" stroke="#64748b" stroke-width="2" />
            <text x="60" y="145" font-family="Arial" font-size="14" text-anchor="middle" fill="#333">Client</text>

            <!-- Arrow to Router -->
            <line x1="100" y1="140" x2="180" y2="140" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)" />

            <!-- Router -->
            <rect x="180" y="80" width="120" height="120" rx="5" fill="#dbeafe" stroke="#3b82f6" stroke-width="2" />
            <text x="240" y="130" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle"
                fill="#1e40af">URL Router</text>
            <text x="240" y="150" font-family="Arial" font-size="10" text-anchor="middle" fill="#1e40af">(Hashing
                Logic)</text>

            <!-- Arrow to Nodes -->
            <line x1="300" y1="140" x2="380" y2="80" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)" />
            <line x1="300" y1="140" x2="380" y2="200" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)" />

            <!-- Node 1 -->
            <rect x="380" y="40" width="100" height="80" rx="5" fill="#dcfce7" stroke="#22c55e" stroke-width="2" />
            <text x="430" y="85" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle"
                fill="#15803d">Node 1</text>
            <text x="430" y="105" font-family="Arial" font-size="10" text-anchor="middle" fill="#15803d">(Keys
                A-M)</text>

            <!-- Node 2 -->
            <rect x="380" y="160" width="100" height="80" rx="5" fill="#fce7f3" stroke="#ec4899" stroke-width="2" />
            <text x="430" y="205" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle"
                fill="#be185d">Node 2</text>
            <text x="430" y="225" font-family="Arial" font-size="10" text-anchor="middle" fill="#be185d">(Keys
                N-Z)</text>

            <defs>
                <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                    <polygon points="0 0, 10 3.5, 0 7" fill="#333" />
                </marker>
            </defs>
        </svg>
        <div class="diagram-caption">Figure 1: Request Flow from Client to Router to Distributed Storage Nodes</div>
    </div>

    <h2>2. Consistent Hashing Mechanism</h2>
    <p>
        The core innovation of this architecture is <strong>Consistent Hashing</strong>. Instead of mapping keys to
        servers using `hash(key) % N` (which breaks when N changes), we map both keys and servers to a circular keyspace
        (the "Hash Ring").
    </p>

    <h3>How It Works:</h3>
    <ul>
        <li><strong>The Ring:</strong> We imagine a circle where positions correspond to hash values from 0 to 2^32.
        </li>
        <li><strong>Node Placement:</strong> Each server is hashed to a position on this ring.</li>
        <li><strong>Key Placement:</strong> Each URL is also hashed to the ring.</li>
        <li><strong>Mapping:</strong> To find where a URL is stored, we move clockwise from the key's position until we
            find the first server.</li>
    </ul>

    <h2>3. Component-Level Design</h2>

    <h3>Client (Dashboard)</h3>
    <p>The **React Application** acts as the user interface. It communicates exclusively with the Router/Load Balancer
        via REST API. It is oblivious to the existence of multiple storage nodes.</p>

    <h3>URL Router</h3>
    <p>The centralized entry point. It maintains a **heartbeat** connection to all registered nodes. If a node fails to
        respond to a heartbeat, the Router removes it from the Hash map, and traffic is automatically rerouted to the
        next available node.</p>

    <h3>Storage Nodes</h3>
    <p>Independent Java Applications running embedded Tomcat servers. Each node is responsible for an isolated shard of
        the data. They are "shared-nothing" architectures, meaning they do not synchronize with each other, simplifying
        the design.</p>

    <footer>
        Generated for Continuous Assessment • Distributed Systems Project
    </footer>

</body>

</html>